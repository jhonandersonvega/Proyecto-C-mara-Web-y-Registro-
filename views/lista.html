<!DOCTYPE html>
<html lang="es" xml:lang="es">
  <head>
    <title>Listado de fotos</title>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />
    <meta name="title" content="Listado de foto" />
    <meta name="description" content="Listado de fotos" />
    <meta name="author" content="Proyecto" />
    <link rel="stylesheet" href="../assets/css/bootstrap.min.css" />
    <link rel="stylesheet" href="../assets/css/dataTables.bootstrap4.min.css" />
    <link rel="stylesheet" href="../assets/css/sweetalert.css" />
    <link rel="stylesheet" href="../assets/css/custom.css" />
    <link rel="stylesheet" href="../assets/css/styles.css" />
  </head>

  <body>
    <div class="container">
      <div class="row-fluid">
        <h1 class="text-center mt-3">Listado de Registro</h1>
        <div class="col-lg-12">
          <p>
            Bienvenidos aquí podrás revisar la lista del ingreso del formulario.
          </p>
          <a
            class="btn btn-success btn-sm float-right"
            type="button"
            href="index.html"
            >Registrar</a
          ><br /><br />
          <div class="row">
            <div class="card-body pad table-responsive">
              <div class="row">
                <div class="col-12">
                  <div class="table-responsive">
                    <table
                      id="tabla"
                      class="table table-striped table-hover table-bordered"
                      width="100%"
                    >
                      <thead>
                        <tr>
                          <th>Fecha</th>
                          <th>DNI</th>
                          <th>Nombre</th>
                          <th>Apellido</th>
                          <th>Email</th>
                          <th>Sexo</th>
                          <th>Firma</th>
                          <th>Foto</th>
                          <th>Acciones</th>
                        </tr>
                      </thead>
                      <tbody id="tablaAlumnos">
                        <!-- Aquí irán los registros generados por PHP -->
                      </tbody>
                    </table>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div
      class="modal fade"
      data-backdrop="static"
      data-keyboard="false"
      tabindex="-1"
      role="dialog"
      id="modalfoto"
    >
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h4 class="modal-title">VISUALIZAR FOTO</h4>
          </div>
          <div class="modal-body">
            <div id="verfotomodal"></div>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn btn-danger btn-sm"
              data-dismiss="modal"
            >
              Cerrar
            </button>
          </div>
        </div>
      </div>
    </div>

    <div
      class="modal fade"
      data-backdrop="static"
      data-keyboard="false"
      tabindex="-1"
      role="dialog"
      id="modaleditar"
    >
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h4 class="modal-title">Editar</h4>
          </div>
          <form id="frm_edit" method="post">
            <div class="modal-body">
              <div id="vermodaleditar">
                <input type="hidden" id="id" name="id" />
                <!-- Campos de entrada para el formulario -->
                <div class="form-group row">
                  <label for="nombre" class="col-lg-6 col-form-label"
                    >Nombre:</label
                  >
                  <div class="col-sm-9">
                    <input
                      type="text"
                      class="form-control form-control-sm"
                      id="nombre"
                      name="nombre"
                    />
                  </div>
                </div>
                <div class="form-group row">
                  <label for="apellido" class="col-lg-6 col-form-label"
                    >Apellido:</label
                  >
                  <div class="col-sm-9">
                    <input
                      type="text"
                      class="form-control form-control-sm"
                      id="apellido"
                      name="apellido"
                    />
                  </div>
                </div>
                <div class="form-group row">
                  <label for="fnac" class="col-lg-6 col-form-label">Fecha de Nacimiento:</label>
                  <div class="col-sm-9">
                      <input
                          type="date"
                          class="form-control form-control-sm"
                          id="fnac"
                          name="fnac"
                          required
                      />
                  </div>
              </div>
                <div class="form-group row">
                  <label for="email" class="col-lg-6 col-form-label"
                    >Correo Electrónico:</label
                  >
                  <div class="col-sm-9">
                    <input
                      type="text"
                      class="form-control form-control-sm"
                      id="email"
                      name="email"
                    />
                  </div>
                </div>
                <div class="form-group row">
                  <label for="dni" class="col-lg-6 col-form-label">DNI:</label>
                  <div class="col-sm-9">
                    <input
                      type="text"
                      class="form-control form-control-sm"
                      id="dni"
                      name="dni"
                    />
                  </div>
                </div>
                <div class="form-group row">
                  <label for="sexo" class="col-lg-6 col-form-label">Sexo:</label>
                  <div class="col-sm-9">
                    <select
                      class="form-control form-control-sm"
                      id="sexo"
                      name="sexo"
                    >
                      <option value="">Selecciona una opción</option>
                      <option value="Masculino">Masculino</option>
                      <option value="Femenino">Femenino</option>
                    </select>
                  </div>
                </div>

                <!-- Radios y contenedores de imagen/video -->
                <div class="form-group row">
                  <div class="form-check radio_check">
                    <input
                      class="form-check-input"
                      type="radio"
                      name="radio_select"
                      id="radiosfoto"
                      value="0"
                      checked
                    />
                    <label class="form-check-label" for="radiosfoto"
                      >Seleccionar Foto</label
                    >
                  </div>
                  <div class="form-check radio_check">
                    <input
                      class="form-check-input"
                      type="radio"
                      name="radio_select"
                      id="radiotfoto"
                      value="1"
                    />
                    <label class="form-check-label" for="radiotfoto"
                      >Tomar Foto</label
                    >
                  </div>
                </div>

                <div class="container_radio">
                  <input
                    type="file"
                    class="form-control-file video_container"
                    name="archivo"
                    id="subirfoto"
                    accept="image/*"
                  />
                  <img id="blah" src="#" alt="Imagen" class="video_container" />
                  <video
                    id="video"
                    autoplay="autoplay"
                    class="video_container none"
                    hidden
                  ></video>
                  <canvas id="canvas" class="none"></canvas>
                  <input type="hidden" id="base64image" name="base64image" />
                </div>
              </div>
            </div>
            <div class="modal-footer">
              <button
                type="submit"
                class="btn btn-primary btn-sm"
                id="btn_edit"
              >
                Editar
              </button>
              <button
                type="button"
                class="btn btn-danger btn-sm"
                data-dismiss="modal"
              >
                Cerrar
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <script src="../assets/js/jquery.min.js"></script>
    <script src="../assets/js/bootstrap.min.js"></script>
    <script src="../assets/js/jquery.dataTables.min.js"></script>
    <script src="../assets/js/dataTables.bootstrap4.min.js"></script>
    <script src="../assets/js/sweetalert.js"></script>
    <script src="../assets/app/camara.js"></script>
    <script src="../assets/app/lista.js"></script>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const video = document.getElementById("video");
        const blah = document.getElementById("blah");

        // Configuración del input file para mostrar la imagen seleccionada
        subirfoto.onchange = (evt) => {
          const [file] = subirfoto.files;
          if (file) {
            const reader = new FileReader();
            reader.onloadend = function () {
              const base64String = reader.result;
              document.getElementById("base64image").value = base64String;
              blah.src = reader.result; // Mostrar la imagen
              blah.hidden = false; // Asegura que la imagen esté visible
              video.hidden = true; // Oculta el video
            };
            reader.readAsDataURL(file);
          }
        };

        // Manejo del cambio entre opciones de radio
        document
          .querySelectorAll('input[name="radio_select"]')
          .forEach((radio) => {
            radio.addEventListener("change", function (evt) {
              const radioValue = evt.target.value;
              if (radioValue == "0") {
                video.hidden = true;
                blah.hidden = false;
              } else if (radioValue == "1") {
                blah.hidden = true;
                video.hidden = false;
              }
            });
          });
      });
    </script>
  </body>
</html>
